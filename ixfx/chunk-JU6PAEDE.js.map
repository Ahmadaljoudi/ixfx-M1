{"version":3,"sources":["../src/collections/Set.ts"],"sourcesContent":["// ✔ UNIT TESTED\n\nimport { ToString } from \"../Util.js\";\nimport {SimpleEventEmitter} from \"../Events.js\";\nimport {SetMutable, ValueSetEventMap} from \"./Interfaces.js\";\n\n/**\n * Creates a {@link SetMutable}.\n * @param keyString Function that produces a key for items. If unspecified uses JSON.stringify\n * @returns \n */\nexport const setMutable = <V>(keyString: ToString<V> | undefined = undefined):SetMutable<V> => new MutableStringSetImpl(keyString);\n\nclass MutableStringSetImpl<V> extends SimpleEventEmitter<ValueSetEventMap<V>> implements SetMutable<V> {\n  // ✔ UNIT TESTED\n  /* eslint-disable functional/prefer-readonly-type */\n  store = new Map<string, V>();\n  keyString: ToString<V>;\n\n  constructor(keyString: ToString<V> | undefined = undefined) {\n    super();\n    \n    if (keyString === undefined) {\n      keyString = (a) => {\n        if (typeof a === `string`) { \n          return a;\n        } else { \n          return JSON.stringify(a);\n        }\n      };\n    }\n    this.keyString = keyString;\n  }\n\n  add(...v: ReadonlyArray<V>) {\n    v.forEach(i => {\n      const isUpdated = this.has(i);\n      this.store.set(this.keyString(i), i);\n      super.fireEvent(`add`, { value: i, updated: isUpdated});\n    });\n  }\n\n  values() {\n    return this.store.values();\n  }\n\n  clear() {\n    this.store.clear();\n    super.fireEvent(`clear`, true);\n  }\n\n  delete(v: V): boolean {\n    const isDeleted = this.store.delete(this.keyString(v));\n    if (isDeleted) super.fireEvent(`delete`, v);\n    return isDeleted;\n  }\n\n  has(v: V): boolean {\n    return this.store.has(this.keyString(v));\n  }\n\n  toArray(): V[] {\n    return Array.from(this.store.values());\n  }\n}"],"mappings":";;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAWO,IAAM,aAAa,CAAI,YAAqC,WAA4B,IAAI,qBAAqB,SAAS;AAEjI,IAAM,uBAAN,cAAsC,mBAAiE;AAAA,EAMrG,YAAY,YAAqC,QAAW;AAC1D,UAAM;AAJR,iCAAQ,oBAAI,IAAe;AAC3B;AAKE,QAAI,cAAc,QAAW;AAC3B,kBAAY,CAAC,MAAM;AACjB,YAAI,OAAO,MAAM,UAAU;AACzB,iBAAO;AAAA,QACT,OAAO;AACL,iBAAO,KAAK,UAAU,CAAC;AAAA,QACzB;AAAA,MACF;AAAA,IACF;AACA,SAAK,YAAY;AAAA,EACnB;AAAA,EAEA,OAAO,GAAqB;AAC1B,MAAE,QAAQ,OAAK;AACb,YAAM,YAAY,KAAK,IAAI,CAAC;AAC5B,WAAK,MAAM,IAAI,KAAK,UAAU,CAAC,GAAG,CAAC;AACnC,YAAM,UAAU,OAAO,EAAE,OAAO,GAAG,SAAS,UAAS,CAAC;AAAA,IACxD,CAAC;AAAA,EACH;AAAA,EAEA,SAAS;AACP,WAAO,KAAK,MAAM,OAAO;AAAA,EAC3B;AAAA,EAEA,QAAQ;AACN,SAAK,MAAM,MAAM;AACjB,UAAM,UAAU,SAAS,IAAI;AAAA,EAC/B;AAAA,EAEA,OAAO,GAAe;AACpB,UAAM,YAAY,KAAK,MAAM,OAAO,KAAK,UAAU,CAAC,CAAC;AACrD,QAAI;AAAW,YAAM,UAAU,UAAU,CAAC;AAC1C,WAAO;AAAA,EACT;AAAA,EAEA,IAAI,GAAe;AACjB,WAAO,KAAK,MAAM,IAAI,KAAK,UAAU,CAAC,CAAC;AAAA,EACzC;AAAA,EAEA,UAAe;AACb,WAAO,MAAM,KAAK,KAAK,MAAM,OAAO,CAAC;AAAA,EACvC;AACF;","names":[]}
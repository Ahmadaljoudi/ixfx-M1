{"version":3,"sources":["../src/IterableAsync.ts"],"sourcesContent":["/* eslint-disable */\n/**\n * \n * ```js\n * chunks([1,2,3,4,5,6,7,8,9,10], 3);\n * // Yields [[1, 2, 3], [4, 5, 6], [7, 8, 9], [10]]\n * ```\n * @param it \n * @param size \n */\nexport async function* chunks<V>(it:Iterable<V>, size:number) {\n  // Source: https://surma.github.io/underdash/\n  let buffer = [];\n  for await (const v of it) {\n    buffer.push(v);\n    if (buffer.length === size) {\n      yield buffer;\n      buffer = [];\n    }\n  }\n  if (buffer.length > 0) yield buffer;\n}\n\nexport async function* concat<V>(...its:readonly Iterable<V>[]) {\n  // Source: https://surma.github.io/underdash/\n\n  for await (const it of its) yield* it;\n}\n\nexport async function* dropWhile<V>(it:AsyncIterable<V>, f:(v:V) => boolean) {\n  // https://surma.github.io/underdash/\n  //const iit = it[Symbol.asyncIterator]();\n  for await (const v of it)\n  { if (!f(v)) {\n    yield v;\n    break;\n  } }\n  yield* it;\n}\n\nexport async function equals<V>(it1:Iterable<V>, it2:Iterable<V>) {\n  // https://surma.github.io/underdash/\n  const iit1 = it1[Symbol.iterator]();\n  const iit2 = it2[Symbol.iterator]();\n  while (true) {\n    const i1 = await iit1.next(), i2 = await iit2.next();\n    if (i1.value !== i2.value) return false;\n    if (i1.done || i2.done) return i1.done && i2.done;\n  }\n}\n\n/**\n * Returns true if `f` returns true for \n * every item in iterable\n * @param it \n * @param f \n * @returns \n */\n export async function every<V>(it:Iterable<V>, f:(v:V) => boolean) {\n  // https://surma.github.io/underdash/\n  let ok = true;\n  for await (const v of it) ok = ok && f(v);\n  return ok;\n}\n\n/**\n * Yields `v` for each item within `it`.\n * \n * ```js\n * fill([1, 2, 3], 0);\n * // Yields: [0, 0, 0]\n * ```\n * @param it \n * @param v \n */\n export async function* fill<V>(it:AsyncIterable<V>, v:V) {\n  // https://surma.github.io/underdash/\n  for await (const _ of it) yield v;\n}\n\n/**\n * ```js\n * filter([1, 2, 3, 4], e => e % 2 == 0);\n * returns [2, 4]\n * ```\n * @param it \n * @param f \n */\n export async function* filter<V>(it:AsyncIterable<V>, f:(v:V) => boolean) {\n  // https://surma.github.io/underdash/\n  for await (const v of it) {\n    if (!f(v)) continue;\n    yield v;\n  }\n}\n\n/**\n * \n * ```js\n * find([1, 2, 3, 4], e => e > 2);\n * // Yields: 3\n * ```\n * @param it \n * @param f \n * @returns \n */\n export async function find<V>(it:Iterable<V>, f:(v:V) => boolean) {\n  // https://surma.github.io/underdash/\n  for await (const v of it)\n  { if (f(v)) return v; } \n}\n\n/**\n * ```js\n * flatten([1, [2, 3], [[4]]]);\n * // Yields: [1, 2, 3, [4]];\n * ```\n * @param it \n */\n export async function* flatten<V>(it:AsyncIterable<V>) {\n  // https://surma.github.io/underdash/\n  for await (const v of it) {\n    if (Symbol.asyncIterator in v) { \n      // @ts-ignore\n      yield* v;\n    } else {\n      yield v;\n    }\n  }\n}\n\n/**\n * \n * @param it \n * @param f \n */\n export async function forEach<V>(it:AsyncIterable<V>, f:(v:V) => boolean) {\n  // https://surma.github.io/underdash/\n  for await (const v of it) f(v);\n}\n\nexport async function* map<V>(it:AsyncIterable<V>, f:(v:V) => boolean) {\n  // https://surma.github.io/underdash/\n  for await (const v of it) \n  { yield f(v); }\n}\n\nexport async function max<V>(it:AsyncIterable<V>, gt = (a:V, b:V) => a > b) {\n  // https://surma.github.io/underdash/\n  let max;\n  for await (const v of it) {\n    if(!max) {\n      max = v;\n      continue;\n    }\n    max = gt(max, v)?max:v;\n  }\n  return max;\n}\n\nexport async function min<V>(it:AsyncIterable<V>, gt = (a:V, b:V) => a > b) {\n  // https://surma.github.io/underdash/\n  let min;\n  for await (const v of it) {\n    if(!min) {\n      min = v;\n      continue;\n    }\n    min = gt(min, v)?v:min;\n  }\n  return min;\n}\n\n/**\n * Returns count from `start` for a given length\n * ```js\n * range(-5, 10);\n * // Yields: [-5, -4, -3, -2, -1, 0, 1, 2, 3, 4]\n * ```\n * @param start \n * @param len \n */\n export async function* range(start:number, len:number) {\n  // https://surma.github.io/underdash/\n  for (let i=0;i<len;i++) {\n    yield start++;\n  }\n  //for (let i=len;len > 0; len--) yield start++;\n}\n\nexport async function reduce<V>(it:AsyncIterable<V>, f:(acc:V, current:V) => V, start:V) {\n  // https://surma.github.io/underdash/\n  for await (const v of it) start = f(start, v);\n  return start;\n}\n\nexport async function* slice<V>(it:AsyncIterable<V>, start = 0, end = Number.POSITIVE_INFINITY) {\n  // https://surma.github.io/underdash/\n  const iit = it[Symbol.asyncIterator]();\n  for(; start > 0; start--, end--) await iit.next();\n  for await (const v of it) \n  { if(end-- > 0)\n  { yield v; }\n  else\n  { break; } }\n}\n\nexport async function some<V>(it:AsyncIterable<V>, f:(v:V) => boolean) {\n  // https://surma.github.io/underdash/\n  for await (const v of it) \n  { if(f(v)) return true; }\n  return false;\n}\n\nexport async function* takeWhile<V>(it:AsyncIterable<V>, f:(v:V) => boolean) {\n  // https://surma.github.io/underdash/\n  for await (const v of it) {\n    if (!f(v)) return;\n    yield v;\n  }\n}\n\n/**\n * Returns an array of values from an iterator.\n * \n * ```js\n * const data = await toArray(adsrSample(opts, 10));\n * ```\n * \n * Note: If the iterator is infinite, be sure to provide a `count` or the function\n * will never return.\n * \n * @param it Asynchronous iterable\n * @param count Number of items to return, by default all.\n * @returns \n */\n export async function toArray<V>(it:AsyncIterable<V>, count = Infinity):Promise<readonly V[]> {\n  // https://2ality.com/2016/10/asynchronous-iteration.html\n  const result = [];\n  const iterator = it[Symbol.asyncIterator]();\n  while (result.length < count) {\n      const {value,done} = await iterator.next();\n      if (done) break;\n      result.push(value);\n  }\n  return result;\n\n}\n\nexport async function* unique<V>(it:AsyncIterable<V>, f:((id:V) => V) = id => id) {\n  // https://surma.github.io/underdash/\n  const buffer = [];\n  for await (const v of it) {\n    const fv = f(v);\n    if (buffer.indexOf(fv) !== -1) continue;\n    buffer.push(fv);\n    yield v;\n  }\n}\n\nexport async function* zip<V>(...its:AsyncIterable<V>[]) {\n  // https://surma.github.io/underdash/\n  const iits = its.map(it => it[Symbol.asyncIterator]());\n  while(true) {\n    const vs = await Promise.all(iits.map(it => it.next()));\n    if (vs.some(v => v.done)) return;\n    yield vs.map(v => v.value);\n  }\n}"],"mappings":"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","names":[]}
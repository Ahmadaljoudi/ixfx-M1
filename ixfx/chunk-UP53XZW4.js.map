{"version":3,"sources":["../src/Random.ts","../src/collections/Arrays.ts","../src/collections/NumericArrays.ts","../src/modulation/Easing.ts"],"sourcesContent":["import { randomIndex, randomElement } from \"./collections/Arrays.js\";\r\nimport {number as guardNumber} from './Guards.js';\r\nimport * as Easings from \"./modulation/Easing.js\";\r\nimport {clamp} from \"./Util.js\";\r\nexport {randomIndex as arrayIndex};\r\nexport {randomElement as arrayElement};\r\n\r\nexport const defaultRandom = Math.random;\r\nexport type RandomSource = () => number;\r\n\r\n/**\r\n * Returns a random number between `min-max` weighted such that values closer to `min`\r\n * occur more frequently\r\n * @param min \r\n * @param max \r\n * @returns \r\n */\r\n// export const weighted2 = (min: number, max: number) => {\r\n//   const r = Math.random() * max;// + min;\r\n//   const x = Math.round(max/r);\r\n//   if (x > max) {\r\n//     console.log(`r: ${r} x: ${x} min: ${min} max: ${max}`);\r\n//   }\r\n//   return x;\r\n// };\r\n\r\n/***\r\n * Returns a random number, 0..1, weighted by a given easing function. \r\n * Default easing is `quadIn`, which skews towards zero.\r\n * \r\n * ```js\r\n * weighted();          // quadIn easing by default, which skews toward low values\r\n * weighted(`quadOut`); // quadOut favours high values\r\n * ```\r\n * \r\n * @param easingName Easing name. `quadIn` by default.\r\n * @param rand Source random generator. `Math.random` by default.\r\n * @returns Random number (0-1)\r\n */\r\nexport const weighted = (easingName:Easings.EasingName = `quadIn`, rand:RandomSource = defaultRandom):number => {\r\n  const r = rand();\r\n  const easingFn = Easings.get(easingName as Easings.EasingName);\r\n  if (easingFn === undefined) throw new Error(`Easing function '${easingName}' not found.`);\r\n  return easingFn(r);\r\n};\r\n\r\n/**\r\n * Random integer, weighted according to an easing function.\r\n * Number will be inclusive of `min` and below `max`.\r\n * \r\n * ```js\r\n * // If only one parameter is provided, it's assumed to be the max:\r\n * // Random number that might be 0 through to 99\r\n * const r = weightedInteger(100);\r\n * \r\n * // If two numbers are given, it's assumed to be min, max\r\n * // Random number that might be 20 through to 29\r\n * const r = weightedInteger(20,30);\r\n * \r\n * // One number and string. First param is assumed to be\r\n * // the max, second parameter the easing function\r\n * const r = weightedInteger(100, `quadIn`)\r\n * ```\r\n * \r\n * Useful for accessing a random array element:\r\n * ```js\r\n * const list = [`mango`, `kiwi`, `grape`];\r\n * // Yields random item from list\r\n * list[weightedInteger(list.length)];\r\n * ```\r\n * \r\n * Note: result from easing function will be clamped to\r\n * the min/max (by default 0-1);\r\n * \r\n * @param max Maximum (exclusive)\r\n * @param min Minimum number (inclusive), 0 by default\r\n * @param rand Source random generator. `Math.random` by default.\r\n * @param easing Easing to use, uses `quadIn` by default\r\n * @returns \r\n */\r\nexport const weightedInteger = (minOrMax:number, maxOrEasing?:number|Easings.EasingName, easing?:Easings.EasingName, rand:RandomSource = defaultRandom) => {\r\n  // Unit tested - for ranges and params types. Haven't tested easing distribution\r\n\r\n  guardNumber(minOrMax);\r\n  //eslint-disable-next-line functional/no-let\r\n  let min, max, easingName;\r\n  easingName = `quadIn`;\r\n  min = 0;\r\n\r\n  if (maxOrEasing === undefined) {\r\n    // No second parameter\r\n    max = minOrMax;\r\n  } else {\r\n    // There is a second parameter\r\n    if (typeof maxOrEasing === `number`) {\r\n      min = minOrMax;\r\n      max = maxOrEasing;\r\n      if (easing !== undefined) easingName = easing;\r\n    } else if (typeof maxOrEasing === `string`) {\r\n      max = minOrMax;\r\n      easingName = maxOrEasing;\r\n    } else {\r\n      throw new Error(`Unexpected value type for maxOrEasing: ${maxOrEasing}`);\r\n    }\r\n  }\r\n  \r\n  if (easing !== undefined) easingName = easing;\r\n\r\n  const easingFn = Easings.get(easingName as Easings.EasingName);\r\n  if (easingFn === undefined) throw new Error(`Easing '${easingName}' not found`);\r\n\r\n  guardNumber(min);\r\n  if (max <= min) throw new Error(`Max should be greater than min`);\r\n  const r = clamp(easingFn(rand()));\r\n  return Math.floor(r * (max-min)) + min;\r\n};\r\n\r\n/**\r\n * Returns a random number with gaussian (ie bell-curved) distribution\r\n * ```js\r\n * // Yields a random number between 0..1\r\n * // with a gaussian distribution\r\n * gaussian();\r\n * ```\r\n * \r\n * Distribution can also be skewed:\r\n * ```js\r\n * // Yields a skewed random value\r\n * gaussian(10);\r\n * ```\r\n * \r\n * Use the curried version in order to pass the random number generator elsewhere:\r\n * ```js\r\n * const g = gaussianSkewed(10);\r\n * // Now it can be called without parameters\r\n * g(); // Yields skewed random\r\n * \r\n * // Eg:\r\n * shuffle(gaussianSkewed(10));\r\n * ```\r\n * @param skew \r\n * @returns \r\n */\r\nexport const gaussian = (skew = 1) => {\r\n  const min = 0;\r\n  const max = 1;\r\n  // Source: https://stackoverflow.com/questions/25582882/javascript-math-random-normal-distribution-gaussian-bell-curve\r\n  \r\n  //eslint-disable-next-line functional/no-let\r\n  let u = 0, v = 0;\r\n  //eslint-disable-next-line functional/no-loop-statement\r\n  while(u === 0) u = Math.random(); //Converting [0,1) to (0,1)\r\n  //eslint-disable-next-line functional/no-loop-statement\r\n  while(v === 0) v = Math.random();\r\n  //eslint-disable-next-line functional/no-let\r\n  let num = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);\r\n  \r\n  num = num / 10.0 + 0.5; // Translate to 0 -> 1\r\n  if (num > 1 || num < 0) {\r\n    num = gaussian(skew);// resample between 0 and 1 if out of range\r\n  } else{\r\n    num = Math.pow(num, skew); // Skew\r\n    num *= max - min; // Stretch to fill range\r\n    num += min; // offset to min\r\n  }\r\n  return num;\r\n};\r\n\r\n/**\r\n * Returns a function of skewed gaussian values.\r\n * \r\n * This 'curried' function is useful when be\r\n * ```js\r\n * const g = gaussianSkewed(10);\r\n * \r\n * // Now it can be called without parameters\r\n * g(); // Returns skewed value\r\n * \r\n * // Eg:\r\n * shuffle(gaussianSkewed(10));\r\n * ```\r\n * @param skew \r\n * @returns \r\n */\r\nexport const gaussianSkewed = (skew:number) => () => gaussian(skew);\r\n\r\n/**\r\n * Returns a string of random letters and numbers of a given `length`.\r\n * \r\n * ```js\r\n * string(4); // eg. `4afd`\r\n * ```\r\n * @param length Length of random string\r\n * @returns Random string\r\n */\r\nexport const string = (length:number) => Math.random().toString(36).substring(2, length+2);\r\n","/**\r\n * Functions for working with primitive arrays, regardless of type\r\n * See Also: NumericArrays.ts\r\n */\r\n\r\nimport {integer as guardInteger} from '~/Guards.js';\r\nimport {defaultRandom, RandomSource} from '../Random.js';\r\nimport {IsEqual, isEqualDefault, isEqualValueDefault} from '../Util.js';\r\n\r\nexport * from './NumericArrays.js';\r\n\r\n/**\r\n * Throws an error if `array` parameter is not a valid array\r\n * @private\r\n * @param array \r\n * @param paramName \r\n */\r\nexport const guardArray = <V>(array:ArrayLike<V>, paramName:string = `?`) => {\r\n  if (array === undefined) throw new Error(`Param '${paramName}' is undefined. Expected array.`);\r\n  if (array === null) throw new Error(`Param '${paramName}' is null. Expected array.`);\r\n  if (!Array.isArray(array)) throw new Error(`Param '${paramName}' not an array as expected`);\r\n};\r\n\r\n/**\r\n * Throws if `index` is an invalid array index for `array`, and if\r\n * `array` itself is not a valid array.\r\n * @param array \r\n * @param index \r\n */\r\nexport const guardIndex = <V>(array:ReadonlyArray<V>, index:number, paramName:string = `index`) => {\r\n  guardArray(array);\r\n  guardInteger(index, `positive`, paramName);\r\n  if (index > array.length -1) throw new Error(`'${paramName}' ${index} beyond array max of ${array.length-1}`);\r\n};\r\n\r\n/**\r\n * Returns _true_ if all the contents of the array are identical\r\n * @param array Array\r\n * @param equality Equality checker. Uses string-conversion checking by default\r\n * @returns \r\n */\r\nexport const areValuesIdentical = <V>(array:ReadonlyArray<V>, equality?:IsEqual<V>):boolean => {\r\n  // Unit tested\r\n\r\n  if (!Array.isArray(array)) throw new Error(`Param 'array' is not an array.`);\r\n  if (array.length === 0) return true;\r\n  const eq = (equality === undefined) ? isEqualValueDefault : equality;\r\n  const a = array[0];\r\n  const r = array.some(v => !eq(a, v));\r\n  if (r) return false;\r\n  return true;\r\n};\r\n\r\n/**\r\n * Zip ombines the elements of two or more arrays based on their index.\r\n * \r\n * ```js\r\n * const a = [1,2,3];\r\n * const b = [`red`, `blue`, `green`];\r\n * \r\n * const c = zip(a, b);\r\n * // Yields:\r\n * // [\r\n * //   [1, `red`],\r\n * //   [2, `blue`],\r\n * //   [3, `green`]\r\n * // ]\r\n * ```\r\n * \r\n * Typically the arrays you zip together are all about the same logical item. Eg, in the above example\r\n * perhaps `a` is size and `b` is colour. So thing #1 (at array index 0) is a red thing of size 1. Before\r\n * zipping we'd access it by `a[0]` and `b[0]`. After zipping, we'd have c[0], which is array of [1, `red`].\r\n * @param arrays \r\n * @returns Zipped together array\r\n */\r\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nexport const zip = (...arrays:ReadonlyArray<any>):ReadonlyArray<any> => {\r\n  // Unit tested\r\n  if (arrays.some((a) => !Array.isArray(a))) throw new Error(`All parameters must be an array`);\r\n  const lengths = arrays.map(a => a.length);\r\n  if (!areValuesIdentical(lengths)) throw new Error(`Arrays must be of same length`);\r\n  const ret = [];\r\n  const len = lengths[0];\r\n  //eslint-disable-next-line functional/no-loop-statement,functional/no-let\r\n  for (let i=0;i<len;i++) {\r\n    //eslint-disable-next-line functional/immutable-data\r\n    ret.push(arrays.map(a => a[i]));\r\n  }\r\n  return ret;\r\n};\r\n\r\n/**\r\n * Returns an copy of `data` with specified length.\r\n * If the input array is too long, it is truncated. \r\n * If the input array is too short, it will the expanded based on the `expand` strategy\r\n *  - undefined: fill with `undefined`\r\n *  - repeat: repeat array elements from position 0\r\n *  - first: continually use first element\r\n *  - last: continually use last element\r\n * \r\n * ```js\r\n * ensureLength([1,2,3], 2); // [1,2]\r\n * ensureLength([1,2,3], 5, `undefined`); // [1,2,3,undefined,undefined]\r\n * ensureLength([1,2,3], 5, `repeat`);    // [1,2,3,1,2]\r\n * ensureLength([1,2,3], 5, `first`);     // [1,2,3,1,1]\r\n * ensureLength([1,2,3], 5, `last`);      // [1,2,3,3,3] \r\n * ```\r\n * @param data \r\n * @param length \r\n */\r\nexport const ensureLength = <V>(data:ReadonlyArray<V>, length:number, expand:`undefined`|`repeat`|`first`|`last` = `undefined`):ReadonlyArray<V> => {\r\n  // Unit tested\r\n  if (data === undefined) throw new Error(`Data undefined`);\r\n  if (!Array.isArray(data)) throw new Error(`data is not an array`);\r\n  if (data.length === length) return [...data];\r\n  if (data.length > length) {\r\n    return data.slice(0, length);\r\n  }\r\n  const d = [...data];\r\n  const add = length - d.length;\r\n  \r\n  //eslint-disable-next-line functional/no-loop-statement,functional/no-let\r\n  for (let i=0;i<add;i++) {\r\n    //eslint-disable-next-line functional/immutable-data\r\n    if (expand === `undefined`) {\r\n      //eslint-disable-next-line functional/immutable-data\r\n      d.push(undefined);\r\n    } else if (expand === `repeat`) {\r\n      //eslint-disable-next-line functional/immutable-data\r\n      d.push(data[i%data.length]);\r\n    } else if (expand === `first`) {\r\n      //eslint-disable-next-line functional/immutable-data\r\n      d.push(data[0]);\r\n    } else if (expand === `last`) {\r\n      //eslint-disable-next-line functional/immutable-data\r\n      d.push(data[data.length-1]);\r\n    }\r\n  }\r\n  return d;\r\n};\r\n\r\n\r\n/**\r\n * Return elements from `array` that match a given `predicate`, and moreover are between the given `startIndex` and `endIndex`.\r\n * \r\n * While this can be done with in the in-built `array.filter` function, it will needless iterate through the whole array. It also\r\n * avoids another alternative of slicing the array before using `filter`.\r\n * @param array \r\n * @param predicate \r\n * @param startIndex \r\n * @param endIndex \r\n */\r\nexport const filterBetween = <V>(array:ReadonlyArray<V>, predicate: (value: V, index: number, array: ReadonlyArray<V>) => boolean, startIndex:number, endIndex:number):readonly V[] => {\r\n  guardIndex(array, startIndex, `startIndex`);\r\n  guardIndex(array, endIndex, `endIndex`);\r\n\r\n  const t:V[] = [];\r\n  //eslint-disable-next-line functional/no-let,functional/no-loop-statement\r\n  for (let i=startIndex;i<=endIndex;i++) {\r\n    //eslint-disable-next-line functional/immutable-data\r\n    if (predicate(array[i], i, array)) t.push(array[i]);\r\n  }\r\n  return t;\r\n};\r\n/**\r\n * Returns a random array index\r\n * @param array\r\n * @param rand Random generator. `Math.random` by default.\r\n * @returns \r\n */\r\nexport const randomIndex = <V>(array: ArrayLike<V>, rand:RandomSource = defaultRandom): number => Math.floor(rand() * array.length);\r\n\r\n/**\r\n * Returns random element\r\n * @param array\r\n * @params rand Random generator. `Math.random` by default.\r\n * @returns \r\n */\r\nexport const randomElement = <V>(array: ArrayLike<V>, rand:RandomSource = defaultRandom): V => {\r\n  guardArray(array, `array`);\r\n  return array[Math.floor(rand() * array.length)];\r\n};\r\n\r\n/**\r\n * Removes a random item from an array, returning both the item and the new array as a result.\r\n * Does not modify the original array unless `mutate` parameter is true.\r\n * \r\n * @example Without changing source\r\n * ```js\r\n * const data = [100, 20, 40];\r\n * const {value, array} = randomPluck(data);\r\n * // value: 20, array: [100, 40], data: [100, 20, 40];\r\n * ```\r\n *\r\n * @example Mutating source\r\n * ```js\r\n * const data = [100, 20, 40];\r\n * const {value} = randomPluck(data, true);\r\n * // value: 20, data: [100, 40];\r\n * ```\r\n * \r\n * @template V Type of array\r\n * @param array Array to pluck item from\r\n * @param mutate If _true_, changes input array. _False_ by default.\r\n * @param random Random generatr. `Math.random` by default.\r\n * @return Returns an object `{value:V|undefined, array:V[]}`\r\n * \r\n */\r\n//eslint-disable-next-line functional/prefer-readonly-type\r\nexport const randomPluck = <V>(array:readonly V[], mutate = false, rand:RandomSource = defaultRandom):{readonly value:V|undefined, readonly array:Array<V> } => {\r\n  if (array === undefined) throw new Error(`array is undefined`);\r\n  if (!Array.isArray(array)) throw new Error(`'array' param is not an array`);\r\n  if (array.length === 0) return {value: undefined, array: []};\r\n  const index = randomIndex(array, rand);\r\n  if (mutate) {\r\n    return {\r\n      value: array[index],\r\n      //eslint-disable-next-line functional/immutable-data\r\n      array: array.splice(index, 1)\r\n    };\r\n  } else {\r\n    // Copy array, remove item from that\r\n    const t = [...array];\r\n    //eslint-disable-next-line functional/immutable-data\r\n    t.splice(index, 1);\r\n    return {\r\n      value: array[index],\r\n      array: t\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Returns a shuffled copy of the input array.\r\n * @example\r\n * ```js\r\n * const d = [1, 2, 3, 4];\r\n * const s = shuffle(d);\r\n * // d: [1, 2, 3, 4], s: [3, 1, 2, 4]\r\n * ```\r\n * @param dataToShuffle \r\n * @param rand Random generator. `Math.random` by default.\r\n * @returns Copy with items moved around randomly\r\n * @template V Type of array items\r\n */\r\nexport const shuffle = <V>(dataToShuffle:ReadonlyArray<V>, rand:RandomSource = defaultRandom): ReadonlyArray<V> => {\r\n  const array = [...dataToShuffle];\r\n  // eslint-disable-next-line functional/no-loop-statement, functional/no-let\r\n  for (let i = array.length - 1; i > 0; i--) {\r\n    const j = Math.floor(rand() * (i + 1));\r\n    [array[i], array[j]] = [array[j], array[i]];\r\n  }\r\n  return array;\r\n};\r\n\r\n/**\r\n * Returns an array with a value omitted. If value is not found, result will be a copy of input.\r\n * Value checking is completed via the provided `comparer` function, or by default checking whether `a === b`.\r\n *\r\n * @example\r\n * ```js\r\n * const data = [100, 20, 40];\r\n * const filtered = without(data, 20); // [100, 40]\r\n * ```\r\n * @template V Type of array items\r\n * @param data Source array\r\n * @param value Value to remove\r\n * @param comparer Comparison function. If not provided {@link isEqualDefault} is used, which compares using `===`\r\n * @return Copy of array without value.\r\n */\r\nexport const without = <V>(data:ReadonlyArray<V>, value:V, comparer:IsEqual<V> = isEqualDefault):ReadonlyArray<V> => data.filter(v => !comparer(v, value));\r\n\r\n/**\r\n * Groups data by a grouper function, returning data as a map with string\r\n * keys and array values.\r\n * \r\n * @example\r\n * ```js\r\n * const data = [\r\n *  { age: 39, city: `London` }\r\n *  { age: 14, city: `Copenhagen` }\r\n *  { age: 23, city: `Stockholm` }\r\n *  { age: 56, city: `London` }\r\n * ];\r\n * const map = groupBy(data, item => data.city); \r\n * ```\r\n * \r\n * Returns a map: \r\n * ```\r\n * London: [{ age: 39, city: `London` }, { age: 56, city: `London` }]\r\n * Stockhom: [{ age: 23, city: `Stockholm` }]\r\n * Copenhagen: [{ age: 14, city: `Copenhagen` }]\r\n * ```\r\n * @param array Array to group\r\n * @param grouper Function that returns a key for a given item\r\n * @template K Type of key to group by. Typically string.\r\n * @template V Type of values\r\n * @returns Map \r\n */\r\nexport const groupBy = <K, V>(array: ReadonlyArray<V>, grouper: (item: V) => K) => array.reduce((store, item) => {\r\n  const key = grouper(item);\r\n  const val = store.get(key);\r\n  if (val === undefined) {\r\n    store.set(key, [item]);\r\n  } else {\r\n    // eslint-disable-next-line functional/immutable-data\r\n    val.push(item);\r\n  }\r\n  return store;\r\n  /* eslint-disable-next-line functional/prefer-readonly-type */\r\n}, new Map<K, V[]>());","import {zip, filterBetween} from './Arrays.js';\r\nimport * as Easings from \"../modulation/Easing.js\";\r\n\r\n/**\r\n * Applies a function to the elements of an array, weighting them based on their relative position.\r\n * \r\n * ```js\r\n * // Six items\r\n * weight([1,1,1,1,1,1], Easings.gaussian());\r\n * \r\n * // Yields:\r\n * // [0.02, 0.244, 0.85, 0.85, 0.244, 0.02]\r\n * ```\r\n * \r\n * Function is expected to map (0..1) => (0..1), such as an {@link Easings.EasingFn}. The input to the\r\n * function is the relative position of an element, so the first element will use fn(0), the middle (0.5) and so on.\r\n * The output of the function s then multiplied by the original value.\r\n * \r\n * In the below example (which is also the default if `fn` is not specified), it is just the\r\n * position which is used to proportion the contents.\r\n * \r\n * ```js\r\n * weight([1,1,1,1,1,1], (relativePos) => relativePos);\r\n * // Yields:\r\n * // [0, 0.2, 0.4, 0.6, 0.8, 1]\r\n * ```\r\n * \r\n * Non-numbers in `data` will be silently ignored.\r\n * @param data Data to process. Assumed to be an array of numbers\r\n * @param fn Function (number)=>number. Returns a weighting based on the given relative position. If unspecified (x) => x is used.\r\n */\r\nexport const weight = (data:readonly number[], fn?:(relativePos:number)=>number):readonly number[] => {\r\n  const f = (fn === undefined) ? (x:number) => x : fn;\r\n  const validNumbers = data.filter(d => typeof d === `number` && !Number.isNaN(d));\r\n  return validNumbers.map((v:number, index:number) => v*f(index/(validNumbers.length-1)));\r\n};\r\n\r\n\r\n/**\r\n * Calculates the average of all numbers in an array.\r\n * Array items which aren't a valid number are ignored and do not factor into averaging.\r\n *\r\n * Use {@link minMaxAvg} if you want min, max and total as well.\r\n * \r\n * @example\r\n * ```\r\n * // Average of a list\r\n * const avg = average(1, 1.4, 0.9, 0.1);\r\n * \r\n * // Average of a variable\r\n * let data = [100,200];\r\n * average(...data);\r\n * ```\r\n * @param data Data to average.\r\n * @returns Average of array\r\n */\r\nexport const average = (...data: readonly number[]): number => {\r\n  // ✔ UNIT TESTED\r\n  if (data === undefined) throw new Error(`data parameter is undefined`);\r\n  const validNumbers = data.filter(d => typeof d === `number` && !Number.isNaN(d));\r\n  const total = validNumbers.reduce((acc, v) => acc + v, 0);\r\n  return total / validNumbers.length;\r\n};\r\n\r\n/**\r\n * Computes an average of an array with a set of weights applied.\r\n * \r\n * Weights can be provided as an array, expected to be on 0..1 scale, with indexes\r\n * matched up to input data. Ie. data at index 2 will be weighed by index 2 in the weightings array.\r\n * \r\n * ```js\r\n * // All items weighted evenly\r\n * averageWeighted([1,2,3], [1,1,1]); // 2\r\n * \r\n * // First item has full weight, second half, third quarter\r\n * averageWeighted([1,2,3], [1, 0.5, 0.25]); // 1.57\r\n * \r\n * // With reversed weighting of [0.25,0.5,1] value is 2.42\r\n * ```\r\n * \r\n * A function can alternatively be provided to compute the weighting based on array index, via {@link weight}.\r\n * \r\n * ```js\r\n * averageWeighted[1,2,3], Easings.gaussian()); // 2.0\r\n * ```\r\n * \r\n * This is the same as:\r\n * ```js\r\n * const data = [1,2,3];\r\n * const w = weight(data, Easings.gaussian());\r\n * const avg = averageWeighted(data, w); // 2.0\r\n * ```\r\n * @param data Data to average\r\n * @param weightings Array of weightings that match up to data array, or an easing function \r\n */\r\nexport const averageWeighted = (data:readonly number[], weightings:(readonly number[])|Easings.EasingFn):number => {\r\n  if (typeof weightings === `function`) weightings = weight(data, weightings);\r\n\r\n  const ww = zip(data, weightings);\r\n  const [totalV, totalW] = ww.reduce((acc, v:number[]) => [acc[0] + (v[0]*v[1]), acc[1] + v[1]], [0, 0]);\r\n  return totalV/totalW;\r\n};\r\n\r\n/**\r\n * Returns the minimum number out of `data`.\r\n * Undefined and non-numbers are silently ignored.\r\n * @param data\r\n * @returns Minimum number\r\n */\r\nexport const min = (...data:readonly number[]):number => {\r\n  const validNumbers = data.filter(d => typeof d === `number` && !Number.isNaN(d));\r\n  return Math.min(...validNumbers);\r\n};\r\n\r\n/**\r\n * Returns the maximum number out of `data`.\r\n * Undefined and non-numbers are silently ignored.\r\n * @param data\r\n * @returns Maximum number\r\n */\r\nexport const max = (...data:readonly number[]):number => {\r\n  const validNumbers = data.filter(d => typeof d === `number` && !Number.isNaN(d));\r\n  return Math.max(...validNumbers);\r\n};\r\n\r\n/**\r\n * Returns the maximum out of `data` without additional processing for speed.\r\n * \r\n * For most uses, {@link max} should suffice.\r\n * @param data \r\n * @returns Maximum\r\n */\r\nexport const maxFast = (data:readonly number[]|Float32Array):number => {\r\n  //eslint-disable-next-line functional/no-let\r\n  let m = Number.MIN_SAFE_INTEGER;\r\n  //eslint-disable-next-line functional/no-loop-statement,functional/no-let\r\n  for (let i=0;i<data.length;i++) {\r\n    m = Math.max(m, data[i]);\r\n  }\r\n  return m;\r\n};\r\n\r\n/**\r\n * Returns the min, max, avg and total of the array.\r\n * Any values that are invalid are silently skipped over.\r\n * \r\n * Use {@link average} if you only need average\r\n * \r\n * @param data\r\n * @param startIndex If provided, starting index to do calculations (defaults full range)\r\n * @param endIndex If provided, the end index to do calculations (defaults full range)\r\n * @returns `{min, max, avg, total}`\r\n */\r\nexport const minMaxAvg = (data: readonly number[], startIndex?:number, endIndex?:number): {\r\n  /**\r\n   * Smallest value in array\r\n   */\r\n  readonly min: number; \r\n  /**\r\n   * Total of all items\r\n   */\r\n  readonly total: number; \r\n  /**\r\n   * Largest value in array\r\n   */\r\n  readonly max: number; \r\n  /**\r\n   * Average value in array\r\n   */\r\n  readonly avg: number;} => {\r\n\r\n  if(data === undefined) throw new Error(`'data' is undefined`);\r\n  if (!Array.isArray(data)) throw new Error(`'data' parameter is not an array`);\r\n  \r\n  if (startIndex === undefined) startIndex = 0;\r\n  if (endIndex === undefined) endIndex = data.length - 1;\r\n\r\n  const validNumbers = filterBetween<number>(data, d => typeof d === `number` && !Number.isNaN(d), startIndex, endIndex);\r\n  const total = validNumbers.reduce((acc, v) => acc + v, 0);\r\n  return {\r\n    total: total,\r\n    max: Math.max(...validNumbers),\r\n    min: Math.min(...validNumbers),\r\n    avg: total / validNumbers.length\r\n  };\r\n};","// Easings from https://easings.net/\r\nimport {interpolate} from '../Util.js';\r\nimport {msElapsedTimer, HasCompletion, relativeTimer, ticksElapsedTimer, TimerSource} from '../flow/Timer.js';\r\n\r\nconst sqrt = Math.sqrt;\r\nconst pow = Math.pow;\r\nconst cos = Math.cos;\r\n//eslint-disable-next-line @typescript-eslint/naming-convention\r\nconst pi = Math.PI;\r\nconst sin = Math.sin;\r\n/*\r\ntype RelativeTimer = {\r\n  reset(): void\r\n  elapsed(): number\r\n  isDone(): boolean\r\n}\r\n\r\ntype TimerSource = (upperBound: number) => RelativeTimer;\r\n\r\nconst msRelativeTimer = function (upperBound: number): RelativeTimer {\r\n  let start = performance.now();\r\n  return {\r\n    reset: () => {\r\n      start = performance.now();\r\n    },\r\n    elapsed: () => clamp((performance.now() - start) / upperBound),\r\n    isDone: () => (performance.now() - start) >= upperBound,\r\n  };\r\n};\r\n\r\nconst tickRelativeTimer = function (upperBound: number): RelativeTimer {\r\n  let start = 0;\r\n  return {\r\n    reset: () => {\r\n      start = 0;\r\n    },\r\n    elapsed: () => clamp(start++ / upperBound),\r\n    isDone: () => start >= upperBound,\r\n  };\r\n};\r\n*/\r\n\r\nexport type EasingFn = (x: number) => number;\r\n\r\n/**\r\n * Creates an easing based on clock time\r\n * @inheritdoc Easing\r\n * @example Time based easing\r\n * ```\r\n * const t = time(`quintIn`, 5*1000); // Will take 5 seconds to complete\r\n * ...\r\n * t.compute(); // Get current value of easing\r\n * t.reset();   // Reset to 0\r\n * t.isDone;    // _True_ if finished\r\n * ```\r\n * @param nameOrFn Name of easing, or an easing function\r\n * @param durationMs Duration in milliseconds\r\n * @returns Easing\r\n */\r\nexport const time = function (nameOrFn: EasingName|EasingFn, durationMs: number):Easing {\r\n  return create(nameOrFn, durationMs, msElapsedTimer);\r\n};\r\n\r\n/**\r\n * Creates an easing based on ticks\r\n * \r\n * @inheritdoc Easing\r\n * @example Tick-based easing\r\n * ```\r\n * const t = tick(`sineIn`, 1000);   // Will take 1000 ticks to complete\r\n * t.compute(); // Each call to `compute` progresses the tick count\r\n * t.reset();   // Reset to 0\r\n * t.isDone;    // _True_ if finished\r\n * ```\r\n * @param nameOrFn Name of easing, or an easing function\r\n * @param durationTicks Duration in ticks\r\n * @returns Easing\r\n */\r\nexport const tick = function (nameOrFn: EasingName|EasingFn, durationTicks: number):Easing {\r\n  return create(nameOrFn, durationTicks, ticksElapsedTimer);\r\n};\r\n\r\n/**\r\n * 'Ease' from `0` to `1` over a delicious curve. Commonly used for animation\r\n * and basic modelling of phyical motion. \r\n * \r\n * Create via {@link tick} or {@link time}, call `compute` to calculate the next\r\n * value in the progression, until you reach `1` or `isDone` returns true.\r\n * \r\n */\r\nexport type Easing = HasCompletion & {\r\n/**\r\n * Computes the current value of the easing\r\n *\r\n * @returns {number}\r\n */\r\n  compute(): number\r\n\r\n/**\r\n * Reset the easing\r\n */\r\n  reset(): void\r\n/**\r\n * Returns true if the easing is complete\r\n *\r\n * @returns {boolean}\r\n */\r\n  get isDone(): boolean\r\n};\r\n\r\n/**\r\n * Creates a new easing by name\r\n *\r\n * @param nameOrFn Name of easing, or an easing function\r\n * @param duration Duration (meaning depends on timer source)\r\n * @param timerSource Timer source. Eg {@link tickRelativeTimer}, {@link msRelativeTimer}\r\n * @returns\r\n */\r\nconst create = function (nameOrFn: EasingName|EasingFn, duration: number, timerSource: TimerSource): Easing {\r\n  //eslint-disable-next-line functional/no-let\r\n  let fn:EasingFn|undefined;\r\n  if (typeof nameOrFn === `function`) fn = nameOrFn;\r\n  else fn = get(nameOrFn);\r\n  if (fn === undefined) throw new Error(`Easing function not found: ${nameOrFn}`);\r\n\r\n  // Get a relative version of timer\r\n  const timer = relativeTimer(duration, timerSource(), true);\r\n\r\n  return {\r\n    get isDone() {\r\n      return timer.isDone;\r\n    },\r\n    compute: () => {\r\n      const relative = timer.elapsed;\r\n      return fn!(relative);\r\n    },\r\n    reset: () => {\r\n      timer.reset();\r\n    }\r\n  };\r\n};\r\n\r\n/**\r\n * Creates an easing function using a simple cubic bezier defined by two points.\r\n * \r\n * Eg: https://cubic-bezier.com/#0,1.33,1,-1.25\r\n *  a:0, b: 1.33, c: 1, d: -1.25\r\n * \r\n * ```js\r\n * // Time-based easing using bezier\r\n * const e = Easings.time(fromCubicBezier(1.33, -1.25), 1000);\r\n * e.compute();\r\n * ```\r\n * @param b\r\n * @param d \r\n * @param t \r\n * @returns Value\r\n */\r\nexport const fromCubicBezier = (b:number, d:number):EasingFn => (t:number) => {\r\n  const s = 1-t;\r\n  const s2 = s*s;\r\n  const t2 = t*t;\r\n  const t3 = t2*t;\r\n  return (3*b*s2*t) + (3*d*s*t2) + (t3);\r\n};\r\n\r\n/**\r\n * Returns a mix of two easing functions.\r\n * \r\n * ```js\r\n * // Get a 50/50 mix of two easing functions at t=0.25\r\n * mix(0.5, 0.25, sineIn, sineOut);\r\n * \r\n * // 10% of sineIn, 90% of sineOut\r\n * mix(0.90, 0.25, sineIn, sineOut);\r\n * ```\r\n * @param amt \r\n * @param balance \r\n * @param easingA \r\n * @param easingB \r\n * @returns \r\n */\r\nexport const mix = (amt:number, balance:number, easingA:EasingFn, easingB:EasingFn) => interpolate(balance, easingA(amt), easingB(amt));\r\n\r\nexport const crossfade = (amt:number, easingA:EasingFn, easingB:EasingFn) => mix(amt, amt, easingA, easingB);\r\n/**\r\n * @private\r\n */\r\nexport type EasingName = keyof typeof functions;\r\n\r\n/**\r\n * Returns an easing function by name, or _undefined_ if not found.\r\n * This is a manual way of working with easing functions. If you want to\r\n * ease over time or ticks, use {@link time} or {@link ticks}.\r\n * \r\n * ```js\r\n * const fn = Easings.get(`sineIn`);\r\n * // Returns 'eased' transformation of 0.5\r\n * fn(0.5); \r\n * ```\r\n * @param easingName eg `sineIn`\r\n * @returns Easing function\r\n */\r\nexport const get = function (easingName: EasingName): EasingFn|undefined {\r\n  if (easingName === null) throw new Error(`easingName is null`);\r\n  if (easingName === undefined) throw new Error(`easingName is undefined`);\r\n  const name = easingName.toLocaleLowerCase();\r\n  const found = Object\r\n    .entries(functions)\r\n    .find(([k, _v]) => k.toLocaleLowerCase() === name);\r\n\r\n  if (found === undefined) return found;\r\n  return found[1];\r\n};\r\n\r\n/**\r\n * @private\r\n * @returns Returns list of available easing names\r\n */\r\nexport const getEasings = function ():readonly string[] {\r\n  return Array.from(Object.keys(functions));\r\n};\r\n\r\n/**\r\n * Returns a roughly gaussian easing function\r\n * @param stdDev \r\n * @returns \r\n */\r\nexport const gaussian = (stdDev:number = 0.4):EasingFn => {\r\n  const a = 1/sqrt(2*pi);\r\n  const mean = 0.5;\r\n  \r\n  return (t:number) => {\r\n    const f = a / stdDev;\r\n    // p:-8 pinched\r\n    //eslint-disable-next-line functional/no-let\r\n    let p = -2.5;// -1/1.25;\r\n    //eslint-disable-next-line functional/no-let\r\n    let c = (t-mean)/stdDev;\r\n    c *= c;\r\n    p *= c;\r\n    const v = f * pow(Math.E, p);// * (2/pi);//0.62;\r\n    if (v > 1) return 1;\r\n    if (v < 0) return 0;\r\n\r\n    //if (v >1) console.log(v);\r\n    //if (v < 0) console.log(v);\r\n    return v;\r\n  };\r\n};\r\n\r\nconst bounceOut = function (x:number): number {\r\n  const n1 = 7.5625;\r\n  const d1 = 2.75;\r\n\r\n  if (x < 1 / d1) {\r\n    return n1 * x * x;\r\n  } else if (x < 2 / d1) {\r\n    return n1 * (x -= 1.5 / d1) * x + 0.75;\r\n  } else if (x < 2.5 / d1) {\r\n    return n1 * (x -= 2.25 / d1) * x + 0.9375;\r\n  } else {\r\n    return n1 * (x -= 2.625 / d1) * x + 0.984375;\r\n  }\r\n};\r\n\r\nconst quintIn = (x:number):number => x * x * x * x * x;\r\nconst quintOut = (x:number):number => 1 - pow(1 - x, 5);\r\nconst arch = (x:number):number => (x * (1-x) * 4);\r\n\r\nexport const functions = {\r\n  arch,\r\n  bell: gaussian(),\r\n  sineIn: (x: number): number => 1 - cos((x * pi) / 2),\r\n  sineOut: (x: number): number => sin((x * pi) / 2),\r\n  quadIn: (x: number): number => x * x,\r\n  quadOut: (x: number): number => 1 - (1 - x) * (1 - x),\r\n  sineInOut: (x: number): number => -(cos(pi * x) - 1) / 2,\r\n  quadInOut: (x: number): number => (x < 0.5 ? 2 * x * x : 1 - pow(-2 * x + 2, 2) / 2),\r\n  cubicIn: (x: number): number => x * x * x,\r\n  cubicOut: (x: number): number => 1 - pow(1 - x, 3),\r\n  quartIn: (x: number): number => x * x * x * x,\r\n  quartOut: (x: number): number => 1 - pow(1 - x, 4),\r\n  quintIn,\r\n  quintOut, //: (x: number): number => 1 - pow(1 - x, 5),\r\n  expoIn: (x: number): number => (x === 0 ? 0 : pow(2, 10 * x - 10)),\r\n  expoOut: (x: number): number => (x === 1 ? 1 : 1 - pow(2, -10 * x)),\r\n  quintInOut: (x: number): number => (x < 0.5 ? 16 * x * x * x * x * x : 1 - pow(-2 * x + 2, 5) / 2),\r\n  expoInOut: (x: number): number => (x === 0\r\n    ? 0\r\n    : x === 1\r\n      ? 1\r\n      : x < 0.5 ? pow(2, 20 * x - 10) / 2\r\n        : (2 - pow(2, -20 * x + 10)) / 2),\r\n  circIn: (x: number): number => 1 - sqrt(1 - pow(x, 2)),\r\n  circOut: (x: number): number => sqrt(1 - pow(x - 1, 2)),\r\n  backIn: (x: number): number => {\r\n    const c1 = 1.70158;\r\n    const c3 = c1 + 1;\r\n\r\n    return c3 * x * x * x - c1 * x * x;\r\n  },\r\n  backOut: (x: number): number => {\r\n    const c1 = 1.70158;\r\n    const c3 = c1 + 1;\r\n\r\n    return 1 + c3 * pow(x - 1, 3) + c1 * pow(x - 1, 2);\r\n  },\r\n  circInOut: (x: number): number => (x < 0.5\r\n    ? (1 - sqrt(1 - pow(2 * x, 2))) / 2\r\n    : (sqrt(1 - pow(-2 * x + 2, 2)) + 1) / 2),\r\n  backInOut: (x: number): number => {\r\n    const c1 = 1.70158;\r\n    const c2 = c1 * 1.525;\r\n\r\n    return x < 0.5\r\n      ? (pow(2 * x, 2) * ((c2 + 1) * 2 * x - c2)) / 2\r\n      : (pow(2 * x - 2, 2) * ((c2 + 1) * (x * 2 - 2) + c2) + 2) / 2;\r\n  },\r\n  elasticIn: (x: number): number => {\r\n    const c4 = (2 * pi) / 3;\r\n\r\n    return x === 0\r\n      ? 0\r\n      : x === 1\r\n        ? 1\r\n        : -pow(2, 10 * x - 10) * sin((x * 10 - 10.75) * c4);\r\n  },\r\n  elasticOut: (x: number): number => {\r\n    const c4 = (2 * pi) / 3;\r\n\r\n    return x === 0\r\n      ? 0\r\n      : x === 1\r\n        ? 1\r\n        : pow(2, -10 * x) * sin((x * 10 - 0.75) * c4) + 1;\r\n  },\r\n  bounceIn: (x: number): number => 1 - bounceOut(1 - x),\r\n  bounceOut: bounceOut,\r\n  elasticInOut: (x: number): number => {\r\n    const c5 = (2 * pi) / 4.5;\r\n\r\n    return x === 0\r\n      ? 0\r\n      : x === 1\r\n        ? 1\r\n        : x < 0.5\r\n          ? -(pow(2, 20 * x - 10) * sin((20 * x - 11.125) * c5)) / 2\r\n          : (pow(2, -20 * x + 10) * sin((20 * x - 11.125) * c5)) / 2 + 1;\r\n  },\r\n  bounceInOut: (x: number): number => (x < 0.5\r\n    ? (1 - bounceOut(1 - 2 * x)) / 2\r\n    : (1 + bounceOut(2 * x - 1)) / 2)\r\n};"],"mappings":"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","names":[]}